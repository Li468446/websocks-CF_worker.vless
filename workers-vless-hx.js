const _0x98a34e=_0x4ee2;(function(_0x5d6c1c,_0x5a3018){const _0x166041=_0x4ee2,_0x2e02c1=_0x5d6c1c();while(!![]){try{const _0x4fe6b6=-parseInt(_0x166041(0x9f))/0x1+parseInt(_0x166041(0x95))/0x2*(-parseInt(_0x166041(0x96))/0x3)+-parseInt(_0x166041(0xd1))/0x4+-parseInt(_0x166041(0xad))/0x5*(-parseInt(_0x166041(0xc2))/0x6)+parseInt(_0x166041(0xc7))/0x7+-parseInt(_0x166041(0xd2))/0x8+-parseInt(_0x166041(0xca))/0x9*(-parseInt(_0x166041(0x9e))/0xa);if(_0x4fe6b6===_0x5a3018)break;else _0x2e02c1['push'](_0x2e02c1['shift']());}catch(_0x48924a){_0x2e02c1['push'](_0x2e02c1['shift']());}}}(_0x4286,0x5c0ab));import{connect}from'cloudflare:sockets';let userID=_0x98a34e(0xc9),proxyIP=_0x98a34e(0xb7);if(!isValidUUID(userID))throw new Error(_0x98a34e(0x8c));function _0x4ee2(_0x2188b2,_0x1f6c9e){const _0x428642=_0x4286();return _0x4ee2=function(_0x4ee20c,_0x324302){_0x4ee20c=_0x4ee20c-0x84;let _0x2ad8b0=_0x428642[_0x4ee20c];return _0x2ad8b0;},_0x4ee2(_0x2188b2,_0x1f6c9e);}export default{async 'fetch'(_0x59c566,_0x25675e,_0x394fa6){const _0x3d85f8=_0x98a34e;try{userID=_0x25675e[_0x3d85f8(0x8e)]||userID,proxyIP=_0x25675e['PROXYIP']||proxyIP;const _0x578681=_0x59c566[_0x3d85f8(0xa5)][_0x3d85f8(0xd0)](_0x3d85f8(0x9b));if(!_0x578681||_0x578681!==_0x3d85f8(0x84)){const _0x5dd33b=new URL(_0x59c566['url']);switch(_0x5dd33b['pathname']){case'/':return new Response(JSON[_0x3d85f8(0xb3)](_0x59c566['cf']),{'status':0xc8});case'/'+userID:{const _0x3f814c=getVLESSConfig(userID,_0x59c566[_0x3d85f8(0xa5)]['get'](_0x3d85f8(0xbb)));return new Response(''+_0x3f814c,{'status':0xc8,'headers':{'Content-Type':'text/plain;charset=utf-8'}});}default:return new Response('Not\x20found',{'status':0x194});}}else return await vlessOverWSHandler(_0x59c566);}catch(_0x21a654){let _0x48f98c=_0x21a654;return new Response(_0x48f98c[_0x3d85f8(0xae)]());}}};async function vlessOverWSHandler(_0x201bf0){const _0xcfae3c=_0x98a34e,_0x546a45=new WebSocketPair(),[_0x1cdd49,_0xb4d0aa]=Object['values'](_0x546a45);_0xb4d0aa[_0xcfae3c(0xc1)]();let _0x609763='',_0x44be47='';const _0x355f6f=(_0x147580,_0x1f4832)=>{const _0x4a8ba5=_0xcfae3c;console[_0x4a8ba5(0xbe)]('['+_0x609763+':'+_0x44be47+']\x20'+_0x147580,_0x1f4832||'');},_0x4222e8=_0x201bf0[_0xcfae3c(0xa5)][_0xcfae3c(0xd0)]('sec-websocket-protocol')||'',_0x18c881=makeReadableWebSocketStream(_0xb4d0aa,_0x4222e8,_0x355f6f);let _0x5a91e3={'value':null},_0x4196b4=null,_0x1bff3b=![];return _0x18c881[_0xcfae3c(0x87)](new WritableStream({async 'write'(_0x403d6e,_0x22b75a){const _0xd520ed=_0xcfae3c;if(_0x1bff3b&&_0x4196b4)return _0x4196b4(_0x403d6e);if(_0x5a91e3[_0xd520ed(0xce)]){const _0x2ce69a=_0x5a91e3[_0xd520ed(0xce)][_0xd520ed(0x93)][_0xd520ed(0xab)]();await _0x2ce69a[_0xd520ed(0xb6)](_0x403d6e),_0x2ce69a[_0xd520ed(0x90)]();return;}const {hasError:_0x490d1a,message:_0x54fb35,portRemote:portRemote=0x1bb,addressRemote:addressRemote='',rawDataIndex:_0x59da99,vlessVersion:vlessVersion=new Uint8Array([0x0,0x0]),isUDP:_0x46a196}=processVlessHeader(_0x403d6e,userID);_0x609763=addressRemote,_0x44be47=portRemote+'--'+Math['random']()+'\x20'+(_0x46a196?_0xd520ed(0xd4):_0xd520ed(0xb2))+'\x20';if(_0x490d1a){throw new Error(_0x54fb35);return;}if(_0x46a196){if(portRemote===0x35)_0x1bff3b=!![];else{throw new Error(_0xd520ed(0x97));return;}}const _0x189f95=new Uint8Array([vlessVersion[0x0],0x0]),_0xdd918=_0x403d6e['slice'](_0x59da99);if(_0x1bff3b){const {write:_0x34303b}=await handleUDPOutBound(_0xb4d0aa,_0x189f95,_0x355f6f);_0x4196b4=_0x34303b,_0x4196b4(_0xdd918);return;}handleTCPOutBound(_0x5a91e3,addressRemote,portRemote,_0xdd918,_0xb4d0aa,_0x189f95,_0x355f6f);},'close'(){const _0x151992=_0xcfae3c;_0x355f6f(_0x151992(0xa7));},'abort'(_0x5195b4){const _0x4cd348=_0xcfae3c;_0x355f6f(_0x4cd348(0xd3),JSON[_0x4cd348(0xb3)](_0x5195b4));}}))[_0xcfae3c(0x99)](_0x446d79=>{const _0x2bec9f=_0xcfae3c;_0x355f6f(_0x2bec9f(0x85),_0x446d79);}),new Response(null,{'status':0x65,'webSocket':_0x1cdd49});}async function handleTCPOutBound(_0x42ef9f,_0x26f373,_0x53b18f,_0x51499a,_0x55ff1e,_0x5bf7b2,_0x39b1c8){async function _0x13c158(_0x458dee,_0x44e199){const _0x2a1c96=_0x4ee2,_0x44f38f=connect({'hostname':_0x458dee,'port':_0x44e199});_0x42ef9f['value']=_0x44f38f,_0x39b1c8(_0x2a1c96(0x94)+_0x458dee+':'+_0x44e199);const _0x2fcf6f=_0x44f38f['writable'][_0x2a1c96(0xab)]();return await _0x2fcf6f[_0x2a1c96(0xb6)](_0x51499a),_0x2fcf6f[_0x2a1c96(0x90)](),_0x44f38f;}async function _0x3d8fc1(){const _0x36e628=_0x4ee2,_0x312fd1=await _0x13c158(proxyIP||_0x26f373,_0x53b18f);_0x312fd1[_0x36e628(0xa1)][_0x36e628(0x99)](_0x4b518d=>{const _0x2a6f90=_0x36e628;console[_0x2a6f90(0xbe)](_0x2a6f90(0x88),_0x4b518d);})['finally'](()=>{safeCloseWebSocket(_0x55ff1e);}),remoteSocketToWS(_0x312fd1,_0x55ff1e,_0x5bf7b2,null,_0x39b1c8);}const _0x52adb2=await _0x13c158(_0x26f373,_0x53b18f);remoteSocketToWS(_0x52adb2,_0x55ff1e,_0x5bf7b2,_0x3d8fc1,_0x39b1c8);}function makeReadableWebSocketStream(_0x57c31f,_0x41f411,_0x59ea47){let _0x4e44dc=![];const _0x47861a=new ReadableStream({'start'(_0x319979){const _0x6ada96=_0x4ee2;_0x57c31f['addEventListener'](_0x6ada96(0xc4),_0x3cd529=>{const _0x5aac99=_0x6ada96;if(_0x4e44dc)return;const _0x2f7ae7=_0x3cd529['data'];_0x319979[_0x5aac99(0xac)](_0x2f7ae7);}),_0x57c31f['addEventListener']('close',()=>{const _0x4f3beb=_0x6ada96;safeCloseWebSocket(_0x57c31f);if(_0x4e44dc)return;_0x319979[_0x4f3beb(0x86)]();}),_0x57c31f[_0x6ada96(0xc6)](_0x6ada96(0x92),_0x2b0083=>{const _0xb7514d=_0x6ada96;_0x59ea47(_0xb7514d(0x91)),_0x319979[_0xb7514d(0x92)](_0x2b0083);});const {earlyData:_0x1b5852,error:_0x159d0f}=base64ToArrayBuffer(_0x41f411);if(_0x159d0f)_0x319979[_0x6ada96(0x92)](_0x159d0f);else _0x1b5852&&_0x319979[_0x6ada96(0xac)](_0x1b5852);},'pull'(_0x21a921){},'cancel'(_0x388f97){if(_0x4e44dc)return;_0x59ea47('ReadableStream\x20was\x20canceled,\x20due\x20to\x20'+_0x388f97),_0x4e44dc=!![],safeCloseWebSocket(_0x57c31f);}});return _0x47861a;}function processVlessHeader(_0x553a06,_0x1ccce9){const _0x69de4b=_0x98a34e;if(_0x553a06[_0x69de4b(0xa3)]<0x18)return{'hasError':!![],'message':_0x69de4b(0xb0)};const _0x2dc444=new Uint8Array(_0x553a06['slice'](0x0,0x1));let _0x10bd3b=![],_0x5dd818=![];stringify(new Uint8Array(_0x553a06[_0x69de4b(0xcf)](0x1,0x11)))===_0x1ccce9&&(_0x10bd3b=!![]);if(!_0x10bd3b)return{'hasError':!![],'message':_0x69de4b(0xba)};const _0x4e1d0b=new Uint8Array(_0x553a06[_0x69de4b(0xcf)](0x11,0x12))[0x0],_0x49c032=new Uint8Array(_0x553a06['slice'](0x12+_0x4e1d0b,0x12+_0x4e1d0b+0x1))[0x0];if(_0x49c032===0x1){}else{if(_0x49c032===0x2)_0x5dd818=!![];else return{'hasError':!![],'message':_0x69de4b(0xd5)+_0x49c032+_0x69de4b(0xa4)};}const _0x17d027=0x12+_0x4e1d0b+0x1,_0x46b324=_0x553a06[_0x69de4b(0xcf)](_0x17d027,_0x17d027+0x2),_0x22ea85=new DataView(_0x46b324)[_0x69de4b(0xa6)](0x0);let _0x22de0b=_0x17d027+0x2;const _0x7df0aa=new Uint8Array(_0x553a06[_0x69de4b(0xcf)](_0x22de0b,_0x22de0b+0x1)),_0x53f7e1=_0x7df0aa[0x0];let _0x55c2ec=0x0,_0x22563f=_0x22de0b+0x1,_0x31eef7='';switch(_0x53f7e1){case 0x1:_0x55c2ec=0x4,_0x31eef7=new Uint8Array(_0x553a06[_0x69de4b(0xcf)](_0x22563f,_0x22563f+_0x55c2ec))[_0x69de4b(0xa8)]('.');break;case 0x2:_0x55c2ec=new Uint8Array(_0x553a06[_0x69de4b(0xcf)](_0x22563f,_0x22563f+0x1))[0x0],_0x22563f+=0x1,_0x31eef7=new TextDecoder()[_0x69de4b(0xaf)](_0x553a06[_0x69de4b(0xcf)](_0x22563f,_0x22563f+_0x55c2ec));break;case 0x3:_0x55c2ec=0x10;const _0x15ab6e=new DataView(_0x553a06[_0x69de4b(0xcf)](_0x22563f,_0x22563f+_0x55c2ec)),_0x2e847b=[];for(let _0x32c695=0x0;_0x32c695<0x8;_0x32c695++){_0x2e847b[_0x69de4b(0xc0)](_0x15ab6e[_0x69de4b(0xa6)](_0x32c695*0x2)[_0x69de4b(0xae)](0x10));}_0x31eef7=_0x2e847b[_0x69de4b(0xa8)](':');break;default:return{'hasError':!![],'message':_0x69de4b(0xb5)+_0x53f7e1};}if(!_0x31eef7)return{'hasError':!![],'message':'addressValue\x20is\x20empty,\x20addressType\x20is\x20'+_0x53f7e1};return{'hasError':![],'addressRemote':_0x31eef7,'addressType':_0x53f7e1,'portRemote':_0x22ea85,'rawDataIndex':_0x22563f+_0x55c2ec,'vlessVersion':_0x2dc444,'isUDP':_0x5dd818};}async function remoteSocketToWS(_0x47082d,_0x3ea229,_0x7e9297,_0x333c1e,_0x58ddbf){const _0x572cc3=_0x98a34e;let _0xf8bd9e=0x0,_0x11fb23=[],_0x2514ff=_0x7e9297,_0x442432=![];await _0x47082d[_0x572cc3(0xcb)]['pipeTo'](new WritableStream({'start'(){},async 'write'(_0x1d369c,_0x29b283){const _0xf7a1b5=_0x572cc3;_0x442432=!![],_0x3ea229['readyState']!==WS_READY_STATE_OPEN&&_0x29b283[_0xf7a1b5(0x92)]('webSocket.readyState\x20is\x20not\x20open,\x20maybe\x20close'),_0x2514ff?(_0x3ea229[_0xf7a1b5(0x8b)](await new Blob([_0x2514ff,_0x1d369c])[_0xf7a1b5(0x8a)]()),_0x2514ff=null):_0x3ea229[_0xf7a1b5(0x8b)](_0x1d369c);},'close'(){const _0x19eec6=_0x572cc3;_0x58ddbf(_0x19eec6(0xaa)+_0x442432);},'abort'(_0x27e558){const _0x4b3a68=_0x572cc3;console[_0x4b3a68(0x92)](_0x4b3a68(0xd6),_0x27e558);}}))[_0x572cc3(0x99)](_0x1de2b5=>{const _0x79d175=_0x572cc3;console[_0x79d175(0x92)]('remoteSocketToWS\x20has\x20exception\x20',_0x1de2b5[_0x79d175(0xb9)]||_0x1de2b5),safeCloseWebSocket(_0x3ea229);}),_0x442432===![]&&_0x333c1e&&(_0x58ddbf(_0x572cc3(0xcd)),_0x333c1e());}function base64ToArrayBuffer(_0x20a3d4){const _0x2b4507=_0x98a34e;if(!_0x20a3d4)return{'error':null};try{_0x20a3d4=_0x20a3d4[_0x2b4507(0xb1)](/-/g,'+')[_0x2b4507(0xb1)](/_/g,'/');const _0x350b03=atob(_0x20a3d4),_0x2de6df=Uint8Array[_0x2b4507(0xc3)](_0x350b03,_0x69f361=>_0x69f361[_0x2b4507(0xb4)](0x0));return{'earlyData':_0x2de6df['buffer'],'error':null};}catch(_0x109a25){return{'error':_0x109a25};}}function isValidUUID(_0x45c195){const _0x14efb5=/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return _0x14efb5['test'](_0x45c195);}const WS_READY_STATE_OPEN=0x1,WS_READY_STATE_CLOSING=0x2;function safeCloseWebSocket(_0x5751be){const _0x20af67=_0x98a34e;try{(_0x5751be['readyState']===WS_READY_STATE_OPEN||_0x5751be[_0x20af67(0xbd)]===WS_READY_STATE_CLOSING)&&_0x5751be[_0x20af67(0x86)]();}catch(_0x2d7772){console['error'](_0x20af67(0x9d),_0x2d7772);}}const byteToHex=[];for(let i=0x0;i<0x100;++i){byteToHex['push']((i+0x100)[_0x98a34e(0xae)](0x10)['slice'](0x1));}function unsafeStringify(_0x56b8a1,_0x469bfd=0x0){const _0x28f3b9=_0x98a34e;return(byteToHex[_0x56b8a1[_0x469bfd+0x0]]+byteToHex[_0x56b8a1[_0x469bfd+0x1]]+byteToHex[_0x56b8a1[_0x469bfd+0x2]]+byteToHex[_0x56b8a1[_0x469bfd+0x3]]+'-'+byteToHex[_0x56b8a1[_0x469bfd+0x4]]+byteToHex[_0x56b8a1[_0x469bfd+0x5]]+'-'+byteToHex[_0x56b8a1[_0x469bfd+0x6]]+byteToHex[_0x56b8a1[_0x469bfd+0x7]]+'-'+byteToHex[_0x56b8a1[_0x469bfd+0x8]]+byteToHex[_0x56b8a1[_0x469bfd+0x9]]+'-'+byteToHex[_0x56b8a1[_0x469bfd+0xa]]+byteToHex[_0x56b8a1[_0x469bfd+0xb]]+byteToHex[_0x56b8a1[_0x469bfd+0xc]]+byteToHex[_0x56b8a1[_0x469bfd+0xd]]+byteToHex[_0x56b8a1[_0x469bfd+0xe]]+byteToHex[_0x56b8a1[_0x469bfd+0xf]])[_0x28f3b9(0xbc)]();}function _0x4286(){const _0x8dac4f=['readableWebSocketStream\x20is\x20abort','udp\x20','command\x20','remoteConnection!.readable\x20abort','websocket','readableWebSocketStream\x20pipeTo\x20error','close','pipeTo','retry\x20tcpSocket\x20closed\x20error','doh\x20success\x20and\x20dns\x20message\x20length\x20is\x20','arrayBuffer','send','uuid\x20is\x20not\x20valid','\x0a\x20\x20server:\x20','UUID','\x0a\x20\x20network:\x20ws\x0a\x20\x20tls:\x20true\x0a\x20\x20udp:\x20false\x0a\x20\x20sni:\x20','releaseLock','webSocketServer\x20has\x20error','error','writable','connected\x20to\x20','2wjjDSc','1123017LuZChC','UDP\x20proxy\x20only\x20enable\x20for\x20DNS\x20which\x20is\x20port\x2053','\x0a\x20\x20client-fingerprint:\x20chrome\x0a\x20\x20ws-opts:\x0a\x20\x20\x20\x20path:\x20\x22/?ed=2048\x22\x0a\x20\x20\x20\x20headers:\x0a\x20\x20\x20\x20\x20\x20host:\x20','catch','https://1.1.1.1/dns-query','Upgrade','\x0a---------------------------------------------------------------\x0a################################################################\x0a','safeCloseWebSocket\x20error','20IdhSGQ','617200BcxTJl','application/dns-message','closed','vless://','byteLength','\x20is\x20not\x20support,\x20command\x2001-tcp,02-udp,03-mux','headers','getUint16','readableWebSocketStream\x20is\x20close','join','&fp=randomized&type=ws&host=','remoteConnection!.readable\x20is\x20close\x20with\x20hasIncomingData\x20is\x20','getWriter','enqueue','40BVZNMY','toString','decode','invalid\x20data','replace','tcp\x20','stringify','charCodeAt','invild\x20\x20addressType\x20is\x20','write','proxyip.us.fxxk.dedyn.io','Stringified\x20UUID\x20is\x20invalid','stack','invalid\x20user','Host','toLowerCase','readyState','log','\x0a---------------------------------------------------------------\x0a################################################################\x0aclash-meta\x0a---------------------------------------------------------------\x0a-\x20type:\x20vless\x0a\x20\x20name:\x20','push','accept','394818xNJgHN','from','message','\x0a################################################################\x0av2ray\x0a---------------------------------------------------------------\x0a','addEventListener','3218656aSLCBx','POST','129428f3-7793-4735-834f-d7568a042180','6756588eKbcuS','readable',':443?encryption=none&security=tls&sni=','retry','value','slice','get','2488936eqJyhq','3975360mIVkOm'];_0x4286=function(){return _0x8dac4f;};return _0x4286();}function stringify(_0x593d7f,_0x273077=0x0){const _0x5beb79=_0x98a34e,_0x5406dc=unsafeStringify(_0x593d7f,_0x273077);if(!isValidUUID(_0x5406dc))throw TypeError(_0x5beb79(0xb8));return _0x5406dc;}async function handleUDPOutBound(_0x267d71,_0x712c64,_0xf526d9){const _0x2bdc8e=_0x98a34e;let _0x8169ad=![];const _0x5e6c9c=new TransformStream({'start'(_0x4c300a){},'transform'(_0x3a2d19,_0x10c87f){const _0x2e1734=_0x4ee2;for(let _0x56de60=0x0;_0x56de60<_0x3a2d19['byteLength'];){const _0x262b81=_0x3a2d19[_0x2e1734(0xcf)](_0x56de60,_0x56de60+0x2),_0x261f96=new DataView(_0x262b81)[_0x2e1734(0xa6)](0x0),_0x4d14f6=new Uint8Array(_0x3a2d19[_0x2e1734(0xcf)](_0x56de60+0x2,_0x56de60+0x2+_0x261f96));_0x56de60=_0x56de60+0x2+_0x261f96,_0x10c87f[_0x2e1734(0xac)](_0x4d14f6);}},'flush'(_0x39a797){}});_0x5e6c9c[_0x2bdc8e(0xcb)][_0x2bdc8e(0x87)](new WritableStream({async 'write'(_0x3c6b70){const _0x495938=_0x2bdc8e,_0x143361=await fetch(_0x495938(0x9a),{'method':_0x495938(0xc8),'headers':{'content-type':_0x495938(0xa0)},'body':_0x3c6b70}),_0x19e578=await _0x143361[_0x495938(0x8a)](),_0x59e436=_0x19e578[_0x495938(0xa3)],_0x477977=new Uint8Array([_0x59e436>>0x8&0xff,_0x59e436&0xff]);_0x267d71['readyState']===WS_READY_STATE_OPEN&&(_0xf526d9(_0x495938(0x89)+_0x59e436),_0x8169ad?_0x267d71[_0x495938(0x8b)](await new Blob([_0x477977,_0x19e578])[_0x495938(0x8a)]()):(_0x267d71[_0x495938(0x8b)](await new Blob([_0x712c64,_0x477977,_0x19e578])[_0x495938(0x8a)]()),_0x8169ad=!![]));}}))[_0x2bdc8e(0x99)](_0x4ff821=>{_0xf526d9('dns\x20udp\x20has\x20error'+_0x4ff821);});const _0x109fc7=_0x5e6c9c[_0x2bdc8e(0x93)]['getWriter']();return{'write'(_0x295103){const _0x2e5b02=_0x2bdc8e;_0x109fc7[_0x2e5b02(0xb6)](_0x295103);}};}function getVLESSConfig(_0x2b2a6c,_0x16848c){const _0x349e8e=_0x98a34e,_0xe102b2=_0x349e8e(0xa2)+_0x2b2a6c+'@'+_0x16848c+_0x349e8e(0xcc)+_0x16848c+_0x349e8e(0xa9)+_0x16848c+'&path=%2F%3Fed%3D2048#'+_0x16848c;return _0x349e8e(0xc5)+_0xe102b2+_0x349e8e(0xbf)+_0x16848c+_0x349e8e(0x8d)+_0x16848c+'\x0a\x20\x20port:\x20443\x0a\x20\x20uuid:\x20'+_0x2b2a6c+_0x349e8e(0x8f)+_0x16848c+_0x349e8e(0x98)+_0x16848c+_0x349e8e(0x9c);}
